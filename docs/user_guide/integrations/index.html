<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://ml-cube.github.io/ml3-platform-docs/user_guide/integrations/ rel=canonical><link href=../modules/labeling/ rel=prev><link href=data_sources/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>Integrations - ML cube Platform Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#integrations class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="ML cube Platform Documentation" class="md-header__button md-logo" aria-label="ML cube Platform Documentation" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ML cube Platform Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Integrations </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://app.platform.mlcube.com/ class=md-tabs__link> Web App </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="ML cube Platform Documentation" class="md-nav__button md-logo" aria-label="ML cube Platform Documentation" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> ML cube Platform Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <div class="md-nav__link md-nav__container"> <a href=../modules/ class="md-nav__link "> <span class=md-ellipsis> Modules </span> </a> <label class="md-nav__link " for=__nav_2_2 id=__nav_2_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../modules/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../modules/retraining/ class=md-nav__link> <span class=md-ellipsis> Retraining </span> </a> </li> <li class=md-nav__item> <a href=../modules/business/ class=md-nav__link> <span class=md-ellipsis> Business mode </span> </a> </li> <li class=md-nav__item> <a href=../modules/labeling/ class=md-nav__link> <span class=md-ellipsis> Labeling </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3 checked> <div class="md-nav__link md-nav__container"> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Integrations </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_2_3 id=__nav_2_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=true> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=data_sources/ class=md-nav__link> <span class=md-ellipsis> Data Sources </span> </a> </li> <li class=md-nav__item> <a href=retrain_triggers/ class=md-nav__link> <span class=md-ellipsis> Retrain triggers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex> <span class=md-ellipsis> Other resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Other resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../rbac/ class=md-nav__link> <span class=md-ellipsis> User Roles </span> </a> </li> <li class=md-nav__item> <a href=../detection_event_rules/ class=md-nav__link> <span class=md-ellipsis> Detection Event Rules </span> </a> </li> <li class=md-nav__item> <a href=../data_schema/ class=md-nav__link> <span class=md-ellipsis> Data Schema </span> </a> </li> <li class=md-nav__item> <a href=../glossary/ class=md-nav__link> <span class=md-ellipsis> Glossary </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../api/ class="md-nav__link "> <span class=md-ellipsis> API </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <div class="md-nav__link md-nav__container"> <a href=../../api/python/ class="md-nav__link "> <span class=md-ellipsis> Python SDK </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Python SDK </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/python/client/ class=md-nav__link> <span class=md-ellipsis> Client </span> </a> </li> <li class=md-nav__item> <a href=../../api/python/models/ class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=../../api/python/exceptions/ class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> <li class=md-nav__item> <a href=../../api/python/enums/ class=md-nav__link> <span class=md-ellipsis> Enums </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <div class="md-nav__link md-nav__container"> <a href=../../api/rest/ class="md-nav__link "> <span class=md-ellipsis> REST </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> REST </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://app.platform.mlcube.com/ class=md-nav__link> <span class=md-ellipsis> Web App </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#creating-the-credentials class=md-nav__link> <span class=md-ellipsis> Creating the credentials </span> </a> </li> <li class=md-nav__item> <a href=#storage-integration class=md-nav__link> <span class=md-ellipsis> Storage integration </span> </a> </li> <li class=md-nav__item> <a href=#retrain-events-integration class=md-nav__link> <span class=md-ellipsis> Retrain events integration </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=integrations>Integrations<a class=headerlink href=#integrations title="Permanent link">&para;</a></h1> <p>Below, you will find a guide that will help you create the credentials and configure the permissions that ML cube will use to access your resources on the supported cloud providers.</p> <h2 id=creating-the-credentials>Creating the credentials<a class=headerlink href=#creating-the-credentials title="Permanent link">&para;</a></h2> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Amazon Web Services</label><label for=__tabbed_1_2>Google Cloud Platform</label><label for=__tabbed_1_3>Microsoft Azure</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/aws.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Amazon Web Services" src=../../imgs/aws.svg style=height:50px;width:50px></a></p> <p>The ML cube Platform can assume an <strong>IAM Role</strong> on your AWS Account, that can be used to authorize actions on specific resources. To create this, log into your AWS account and open the AWS console. Here, go to the <strong>IAM</strong> service, navigate to the <strong>Roles</strong> section and create a new role. When asked, select the <strong>Custom trust policy</strong> option and paste the following json:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=p>{</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span><span class=nt>&quot;Version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2012-10-17&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=nt>&quot;Statement&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>            </span><span class=nt>&quot;Sid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Statement1&quot;</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>            </span><span class=nt>&quot;Effect&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Allow&quot;</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>            </span><span class=nt>&quot;Principal&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>                </span><span class=nt>&quot;AWS&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;arn:aws:iam::883313729965:root&quot;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>            </span><span class=p>},</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>            </span><span class=nt>&quot;Action&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sts:AssumeRole&quot;</span><span class=p>,</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>            </span><span class=nt>&quot;Condition&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>                </span><span class=nt>&quot;StringEquals&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>                    </span><span class=nt>&quot;sts:ExternalId&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&lt;EXTERNAL_ID&gt;&quot;</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>                </span><span class=p>}</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span><span class=p>]</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=p>}</span>
</span></code></pre></div> <p><code>883313729965</code> is the ID of the AWS Account used by the ML cube Platform. It is important that this value is not changed. We will populate the value of <code>&lt;EXTERNAL_ID&gt;</code> in a later step. Give your role a name and save it.</p> <p>Now, you will need to create the credentials through the ML cube Platform SDK or the web application.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <p>The following code will create a set of AWS credentials from the IAM Role we just created.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>aws_creds</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>create_aws_integration_credentials</span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=n>name</span><span class=o>=</span><span class=s1>&#39;AWS_01&#39;</span><span class=p>,</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># Set these credentials as the default to use when not specified</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>project_id</span><span class=o>=</span><span class=s1>&#39;your_project_id&#39;</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>role_arn</span><span class=o>=</span><span class=s1>&#39;arn:aws:iam::{{YOUR_AWS_ACCOUNT_ID}}:role/{{YOUR_ROLE_NAME}}&#39;</span><span class=p>,</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=p>)</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=n>trust_policy</span> <span class=o>=</span> <span class=n>aws_creds</span><span class=o>.</span><span class=n>generate_trust_policy</span><span class=p>()</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=nb>print</span><span class=p>(</span><span class=n>trust_policy</span><span class=p>)</span>
</span></code></pre></div> </div> <p>You can call the <code>generate_trust_policy</code> function on the created credentials to obtain the <strong>trust policy</strong>. Edit your IAM Role and change the <strong>trust policy</strong> to the one you just obtained.</p> <p>Right now, your <strong>IAM Role</strong> grants no permissions. Please refer to the next sections that will explain how to set up <strong>IAM Policies</strong> for S3, Event Bridge and so on.</p> <p>To revoke access, simply delete the role or change the trust policy.</p> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/gcp.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Google Cloud Platform" src=../../imgs/gcp.svg style=height:50px;width:50px></a></p> <p>The ML cube Platform can operate in your GCP Account through the creation of a dedicated <strong>Service Account</strong>. You will then be able to assign one or more <strong>IAM Roles</strong> to this Service Account, to allow the ML cube Platform to perform specific actions.</p> <p>To configure a Service Account for ML cube Platform, log into your GCP account, select the correct project and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. Now we will enter some commands that will create the <strong>Service Account</strong> with the required permissions. A description of each command is provided to help you understand its purpose.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Change this according to your project</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nb>export</span><span class=w> </span><span class=nv>GCP_PROJECT</span><span class=o>=</span>my-project
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1># Creates a service account called ml3PlatformServiceAccount</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>gcloud<span class=w> </span>iam<span class=w> </span>service-accounts<span class=w> </span>create<span class=w> </span>ml3PlatformServiceAccount<span class=w> </span>--display-name<span class=w> </span><span class=s2>&quot;ML3 Platform Service Account&quot;</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1># Generates the access key that will be used to authenticate as the service account</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>gcloud<span class=w> </span>iam<span class=w> </span>service-accounts<span class=w> </span>keys<span class=w> </span>create<span class=w> </span>ml3-platform-key.json<span class=w> </span>--iam-account<span class=o>=</span>ml3PlatformServiceAccount@<span class=nv>$GCP_PROJECT</span>.iam.gserviceaccount.com
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1># Displays the access key to the terminal screen</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>cat<span class=w> </span>ml3-platform-key.json
</span></code></pre></div> <p>Copy the JSON object containing the key and save it to a file with the same name on your disk. Now, you will need to create the GCP credentials, either through the SDK or the web application, and provide the contents of the JSON file you just created.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <p>The following code will create a set of GCP credentials that will be able to access the service account.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;path/to/ml3-platform-key.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>creds_json</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=n>gcp_creds</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>create_gcp_integration_credentials</span><span class=p>(</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>        <span class=n>name</span><span class=o>=</span><span class=s1>&#39;GCP_01&#39;</span><span class=p>,</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>        <span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># Set these credentials as the default to use when not specified</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>        <span class=n>project_id</span><span class=o>=</span><span class=s1>&#39;your_project_id&#39;</span><span class=p>,</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>        <span class=n>service_account_info_json</span><span class=o>=</span><span class=n>creds_json</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>    <span class=p>)</span>
</span></code></pre></div> </div> <p>Right now, your <strong>IAM Role</strong> grants no permissions. Please refer to the next sections that will explain how to set up <strong>IAM Policies</strong> for Google Cloud Storage, Pub/Sub and so on.</p> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/azure.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Microsoft Azure" src=../../imgs/azure.svg style=height:50px;width:50px></a></p> <p>The ML cube Platform can operate in your Azure Account through the creation of a dedicated <strong>Service Principal</strong>. You will then be able to assign one or more <strong>Roles</strong> to this Service Principal, to allow the ML cube Platform to perform specific actions.</p> <p>To configure a Service Principal for ML cube Platform, log into your Azure account, select the correct project and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. Set the Cloud Shell to use bash instead of powershell. Now we will enter the following command that will create the <strong>Service Principal</strong>.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>az<span class=w> </span>ad<span class=w> </span>sp<span class=w> </span>create-for-rbac<span class=w> </span>--name<span class=w> </span>ML3PlatformSP<span class=w> </span>--skip-assignment
</span></code></pre></div> <p>Once the operation finishes running, it will output a JSON object with the following fields: <code>appId</code>, <code>displayName</code>, <code>password</code> and <code>tenant</code>. Copy this object and save it to a file on your disk, for example <code>azure-credentials.json</code>.</p> <p>Now, you will need to create the Azure credentials, either through the SDK or the web application, and provide the contents of the JSON file you just created.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <p>The following code will create a set of Azure credentials that will be able to access the service account.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;path/to/azure-credentials.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>creds_json</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=n>azure_creds</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>create_azure_integration_credentials</span><span class=p>(</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>        <span class=n>name</span><span class=o>=</span><span class=s1>&#39;AZURE_01&#39;</span><span class=p>,</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>        <span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># Set these credentials as the default to use when not specified</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>        <span class=n>project_id</span><span class=o>=</span><span class=s1>&#39;your_project_id&#39;</span><span class=p>,</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>        <span class=n>service_principal_credentials_json</span><span class=o>=</span><span class=n>creds_json</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>    <span class=p>)</span>
</span></code></pre></div> </div> </div> </div> </div> <h2 id=storage-integration>Storage integration<a class=headerlink href=#storage-integration title="Permanent link">&para;</a></h2> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>AWS S3</label><label for=__tabbed_2_2>Google Cloud Storage</label><label for=__tabbed_2_3>Azure Blob Storage</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/aws.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Amazon Web Services" src=../../imgs/aws.svg style=height:50px;width:50px></a></p> <p>Log into your AWS account and open the AWS console, then go to the <strong>IAM</strong> service and navigate to the <strong>Policies</strong> section. Here, we will create an <strong>IAM Policy</strong>.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <p>The following policy will grant read access to objects in the <code>my-company-data-bucket</code> to the IAM entity it is attached to.</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=p>{</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=nt>&quot;Version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2012-10-17&quot;</span><span class=p>,</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=nt>&quot;Statement&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>            </span><span class=nt>&quot;Sid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Statement1&quot;</span><span class=p>,</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>            </span><span class=nt>&quot;Effect&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Allow&quot;</span><span class=p>,</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>            </span><span class=nt>&quot;Action&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>                </span><span class=s2>&quot;s3:GetBucketTagging&quot;</span><span class=p>,</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>                </span><span class=s2>&quot;s3:GetObject&quot;</span><span class=p>,</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>                </span><span class=s2>&quot;s3:ListBucket&quot;</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>            </span><span class=p>],</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>            </span><span class=nt>&quot;Resource&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>                </span><span class=s2>&quot;arn:aws:s3:::my-company-data-bucket&quot;</span><span class=p>,</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>                </span><span class=s2>&quot;arn:aws:s3:::my-company-data-bucket/*&quot;</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>            </span><span class=p>]</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>    </span><span class=p>]</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=p>}</span>
</span></code></pre></div> </div> <p>Once the <strong>IAM Policy</strong> has been created, navigate to the <strong>Roles</strong> section, select the <strong>IAM Role</strong> you previously created and finally attach the <strong>IAM Policy</strong> to it.</p> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/gcp.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Google Cloud Platform" src=../../imgs/gcp.svg style=height:50px;width:50px></a></p> <p>Log into your GCP account, select the correct project and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. Now we will enter some commands that will create an <strong>IAM Role</strong> with the required permissions, bind it to the service account you previously created, and grant access to the bucket. A description of each command is provided to help you understand its purpose.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Change these according to your project and bucket</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=nb>export</span><span class=w> </span><span class=nv>GCP_PROJECT</span><span class=o>=</span>my-project
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=nb>export</span><span class=w> </span><span class=nv>GCP_BUCKET</span><span class=o>=</span>my-company-data-bucket
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1># Creates an IAM Role called ml3PlatformStorageRole for your project, with read permissions on buckets and objects in the storage service</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>gcloud<span class=w> </span>iam<span class=w> </span>roles<span class=w> </span>create<span class=w> </span>ml3PlatformStorageRole<span class=w> </span>--project<span class=o>=</span><span class=nv>$GCP_PROJECT</span><span class=w> </span>--title<span class=o>=</span><span class=s2>&quot;ML3 Platform Storage Role&quot;</span><span class=w> </span>--description<span class=o>=</span><span class=s2>&quot;Role that allows the ML cube Platform to access storage resources in a project&quot;</span><span class=w> </span>--permissions<span class=o>=</span>storage.buckets.get,storage.buckets.list,storage.objects.get,storage.objects.list<span class=w> </span>--stage<span class=o>=</span>ALPHA
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=c1># Adds the IAM Role to the previously created service account</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>gcloud<span class=w> </span>projects<span class=w> </span>add-iam-policy-binding<span class=w> </span><span class=nv>$GCP_PROJECT</span><span class=w> </span>--member<span class=o>=</span>serviceAccount:ml3PlatformServiceAccount@<span class=nv>$GCP_PROJECT</span>.iam.gserviceaccount.com<span class=w> </span>--role<span class=o>=</span>projects/<span class=nv>$GCP_PROJECT</span>/roles/ml3PlatformStorageRole
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=c1># Allows the service account we created to access the given bucket with the objectViewer role</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>gsutil<span class=w> </span>iam<span class=w> </span>ch<span class=w> </span>serviceAccount:ml3PlatformServiceAccount@<span class=nv>$GCP_PROJECT</span>.iam.gserviceaccount.com:roles/storage.objectViewer<span class=w> </span>gs://<span class=nv>$GCP_BUCKET</span>
</span></code></pre></div> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/azure.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Microsoft Azure" src=../../imgs/azure.svg style=height:50px;width:50px></a></p> <p>Log into your Azure account and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. The following command will associate the previously created Service Principal with a role that is able to read data from a given blob container.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Change these according to your project and storage configuration</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=nb>export</span><span class=w> </span><span class=nv>SERVICE_PRINCIPAL_APP_ID</span><span class=o>=</span>my-sp-app-id
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=nb>export</span><span class=w> </span><span class=nv>SUBSCRIPTION_ID</span><span class=o>=</span>my-azure-subscription-id
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=nb>export</span><span class=w> </span><span class=nv>RESOURCE_GROUP</span><span class=o>=</span>my-azure-resource-group
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=nb>export</span><span class=w> </span><span class=nv>STORAGE_ACCOUNT</span><span class=o>=</span>my-storage-account
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=nb>export</span><span class=w> </span><span class=nv>BLOB_CONTAINER</span><span class=o>=</span>my-blob-container
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>az<span class=w> </span>role<span class=w> </span>assignment<span class=w> </span>create<span class=w> </span>--assignee<span class=w> </span><span class=nv>$SERVICE_PRINCIPAL_APP_ID</span><span class=w> </span>--role<span class=w> </span><span class=s2>&quot;Storage Blob Data Reader&quot;</span><span class=w> </span>--scope<span class=w> </span>/subscriptions/<span class=nv>$SUBSCRIPTION_ID</span>/resourceGroups/<span class=nv>$RESOURCE_GROUP</span>/providers/Microsoft.Storage/storageAccounts/<span class=nv>$STORAGE_ACCOUNT</span>/blobServices/default/containers/<span class=nv>$BLOB_CONTAINER</span>
</span></code></pre></div> </div> </div> </div> <h2 id=retrain-events-integration>Retrain events integration<a class=headerlink href=#retrain-events-integration title="Permanent link">&para;</a></h2> <div class="tabbed-set tabbed-alternate" data-tabs=3:3><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><input id=__tabbed_3_3 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Amazon EventBridge</label><label for=__tabbed_3_2>GCP Pub/Sub</label><label for=__tabbed_3_3>Azure Event Grid</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/aws.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Amazon Web Services" src=../../imgs/aws.svg style=height:50px;width:50px></a></p> <p>Log into your AWS account and open the AWS console, then go to the <strong>IAM</strong> service and navigate to the <strong>Policies</strong> section. Here, we will create an <strong>IAM Policy</strong>.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <p>The following policy will allow an <strong>IAM Entity</strong> to put events in a specific event bus.</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=p>{</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=nt>&quot;Version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2012-10-17&quot;</span><span class=p>,</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=nt>&quot;Statement&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>            </span><span class=nt>&quot;Sid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Statement1&quot;</span><span class=p>,</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>            </span><span class=nt>&quot;Effect&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Allow&quot;</span><span class=p>,</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>            </span><span class=nt>&quot;Action&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>                </span><span class=s2>&quot;events:PutEvents&quot;</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>            </span><span class=p>],</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>            </span><span class=nt>&quot;Resource&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>                </span><span class=s2>&quot;arn:aws:events:&lt;REGION&gt;:&lt;ACCOUNT_ID&gt;:event-bus/&lt;EVENT_BUS_NAME&gt;&quot;</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>            </span><span class=p>]</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>    </span><span class=p>]</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=p>}</span>
</span></code></pre></div> <p>Replace <code>&lt;REGION&gt;</code>, <code>&lt;ACCOUNT_ID&gt;</code> and <code>&lt;EVENT_BUS_NAME&gt;</code> with your desired values.</p> </div> <p>Once the <strong>IAM Policy</strong> has been created, navigate to the <strong>Roles</strong> section, select the <strong>IAM Role</strong> you previously created and finally attach the <strong>IAM Policy</strong> to it.</p> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/gcp.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Google Cloud Platform" src=../../imgs/gcp.svg style=height:50px;width:50px></a></p> <p>Log into your GCP account, select the correct project and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. Now we will enter some commands that will create an <strong>IAM Policy</strong> with the required permissions, bind it to the service account you previously created, and grant access to the Pub/Sub topic. A description of each command is provided to help you understand its purpose.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Change these according to your project and topic</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=nb>export</span><span class=w> </span><span class=nv>GCP_PROJECT</span><span class=o>=</span>my-project
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=nb>export</span><span class=w> </span><span class=nv>GCP_TOPIC</span><span class=o>=</span>my-topic
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1># Adds a new IAM Policy to the previously created service account, granting publish access to the Pub/Sub topic</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>gcloud<span class=w> </span>pubsub<span class=w> </span>topics<span class=w> </span>add-iam-policy-binding<span class=w> </span><span class=nv>$GCP_TOPIC</span><span class=w> </span>--member<span class=o>=</span>serviceAccount:ml3PlatformServiceAccount@<span class=nv>$GCP_PROJECT</span>.iam.gserviceaccount.com<span class=w> </span>--role<span class=o>=</span>roles/pubsub.publisher
</span></code></pre></div> </div> <div class=tabbed-block> <p><a class=glightbox href=../../imgs/azure.svg data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt="Microsoft Azure" src=../../imgs/azure.svg style=height:50px;width:50px></a></p> <p>Log into your Azure account and open the <strong>Cloud Shell</strong>. You can find the button to open it in the upper-right corner of the page. The following command will associate the previously created Service Principal with a role that is able to publish events to an Event Grid topic.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Change these according to your project and storage configuration</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=nb>export</span><span class=w> </span><span class=nv>SERVICE_PRINCIPAL_APP_ID</span><span class=o>=</span>my-sp-app-id
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nb>export</span><span class=w> </span><span class=nv>SUBSCRIPTION_ID</span><span class=o>=</span>my-azure-subscription-id
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=nb>export</span><span class=w> </span><span class=nv>RESOURCE_GROUP</span><span class=o>=</span>my-azure-resource-group
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=nb>export</span><span class=w> </span><span class=nv>TOPIC_ID</span><span class=o>=</span>my-topic
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>az<span class=w> </span>role<span class=w> </span>assignment<span class=w> </span>create<span class=w> </span>--assignee<span class=w> </span><span class=nv>$SERVICE_PRINCIPAL_APP_ID</span><span class=w> </span>--role<span class=w> </span><span class=s2>&quot;EventGrid Data Sender&quot;</span><span class=w> </span>--scope<span class=w> </span>/subscriptions/<span class=nv>$SUBSCRIPTION_ID</span>/resourceGroups/<span class=nv>$RESOURCE_GROUP</span>/providers/Microsoft.EventGrid/topics/<span class=nv>$TOPIC_ID</span>
</span></code></pre></div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../modules/labeling/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Labeling"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Labeling </div> </div> </a> <a href=data_sources/ class="md-footer__link md-footer__link--next" aria-label="Next: Data Sources"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Data Sources </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.1e8ae164.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>